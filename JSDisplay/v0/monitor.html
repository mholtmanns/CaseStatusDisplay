<!doctype html>

<html>
  <head>
    <title>Testing SVG</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
    <style>
      body {
        text-align: center;
      }
          
      p {
        display: block;
        width: 450px;
        margin: 2em auto;
        text-align: left;
      }
    </style>
    <div id="container" style="text-align:center;" width="500px" height="500px">
        <svg id="flag" version="1.1" width="800" height="200" xmlns="http://www.w3.org/2000/svg" style="float: center;">
            <defs>
                <clipPath id="visible">
                    <rect x="0" y="0" width="400" height="200" />
                </clipPath>
            </defs>
                <svg id="leftflag" x="0" width="400" height="200" style="float: left;">
                    <rect width="100%" height="100%" fill-opacity="0" stroke="green" />
                    <circle cx="200" cy="100" r="80" fill="green" />
                    <text x="200" y="125" font-size="60" text-anchor="middle" fill="white">ABC</text>
                </svg>
                <svg id="rightflag" x="400" width="400" height="200" style="float: right;">
                    <rect width="100%" height="100%" fill-opacity="0" stroke="blue" />
                    <circle cx="200" cy="100" r="80" fill="green" />
                    <text x="200" y="125" font-size="60" text-anchor="middle" fill="white">DEF</text>
                </svg>
        </svg>
    </div>
    <script>
        var svgns  = "http://www.w3.org/2000/svg";
        let offset = 300;
        let count  = 300;
        const measurements = new Array(400);
        window.onload = function(){
            let graph = document.getElementById('flag');
            graph.setAttribute('clip-path', 'url(#visible)');
            setInterval(function() {
                let h = Math.floor(Math.random() * 180);
                if ((count - offset) == 400) {

                }
                //measurements[count - offset] = h;
                // document.getElementById('flag').setAttribute('transform', 'translate(1,0)');
                let new_line = document.createElementNS(svgns, 'line');
                new_line.setAttributeNS(null, 'id', 'l' + count);
                new_line.setAttributeNS(null, 'x1', count);
                new_line.setAttributeNS(null, 'y1', '200');
                new_line.setAttributeNS(null, 'x2', count);
                new_line.setAttributeNS(null, 'y2', h);
                new_line.setAttributeNS(null, 'stroke', 'red');
                new_line.setAttributeNS(null, 'stroke-width', '1');
                document.getElementById('flag').appendChild(new_line);
                let tr = -1 * (count - offset);
                document.getElementById('flag').setAttribute('transform', 'translate(' + tr + ',0)');
                tr = -1 * tr;
                document.getElementById('visible').setAttribute('transform', 'translate(' + tr + ',0)');
                count = count + 1;
            }, 100);
        }
    </script>
  </head>
</html>